{% import "bootstrap/wtf.html" as wtf %}
{% extends "layout.html" %}

{% block content %}
<div class="container mt-4">
    <form id=myform method="post" name="ranking_form">
        {{ ranking_form.csrf_token }}
        Team Title: {{ ranking_form.title }}<br>
        <div>
            <table>
                <tr>
                    <th> item name </th>
                    <th> place </th>
                    <th> price </th>
                    <th> item image url</th>
                    <th> item image </th>
                    <th> delete </th>
                </tr>
                {% for item in ranking_form.items %}
                <tr>
                    <td>{{ item.item_name }}</td>
                    <td>{{ item.place }}</td>
                    <td>{{ item.price }}</td>
                    <td class="item_image_url">{{ item.item_image }}</td>
                    <td><img class="item_image" src="{{ item.item_image.data }}" alt="" border=3 height=50 width=50></img></td>
                    <td><button class="rowdel">Del</button></td>
                </tr>
                {% endfor %}
            </table>
        </div>

        <input type="button" value="行追加" onClick="addlineform();">
        <input type="button" value="送信" onClick="submitform();">



    </form>
    
</div>
<script>
    $('.item_image_url').change(function(){
        var item_image_url = $(this).closest('tr').find('input').val();
        $(this).closest('tr').find('.item_image').attr('src', item_image_url)
    });


    $('.rowdel').click(function() {
            let row = $(this).closest("tr").remove();
        $(row).remove();
    });

    $(function(){
        $('input').keypress(function(e){
            if(e.which == 13) {
                return false;
            }
        });
    });

    function addlineform(){
        $('<input>').attr({
            type: 'hidden',
            name: 'addline',
            value: true
        }).appendTo('#myform');
        $('#myform').submit()
    }

    function submitform(){
        $('<input>').attr({
            type: 'hidden',
            name: 'submitform',
            value: true
        }).appendTo('#myform');
        $('#myform').submit()
    }
</script>
{% endblock %}
